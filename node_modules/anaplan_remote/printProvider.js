const fs = require('fs'),
	path = require('path'),
	request = require('request'),
	imageFileNames = require('./imageFileNames');

let printProvider = ( img, name, printPath ) => {
	let newName = name.replace(/\s|\//gi,'-').toLowerCase();

	let download = ( uri, filename, callback ) => {
		request.head( uri, ( err, res, body ) => {
			request(uri).pipe(fs.createWriteStream(filename)).on('close', callback);
		});
	}

	printPath = path.join(printPath, "tile-icon");

	fs.mkdir( printPath, ( err ) => {

		if ( err ) {
			console.log( err );
		}
		let file = path.join(printPath, "tile-icon-" + newName + '.png');
		
		download(img, file, () => {
			console.log('download complete');
		});

	});

};

module.exports = printProvider;
